<template>
  <VueFinalModal
    class="flex justify-center items-center"
    content-class="flex flex-row h-5/6 w-fit max-w-5/6 bg-slate-600 p-8 rounded-xl"
  >
    <div
      class="flex flex-col h-fit"
    >
      <img
        :src="'/zzzoptimizer/_nuxt/assets/images/discs/' + set + '.webp'"
        class="h-20 m-5"  
      />
      <span class="text-white"> {{ set }}</span>
    </div>
    
    <div
      class="flex flex-col h-fit"
    >
      <div
        v-for="param in stats"
        class="flex flex-row"
      >
        <div class="w-12">{{ param }}</div>
        <svg 
          v-for="rect in 5" 
          @click="() => clickToValue(param, rect)" 
          class="ml-0.5 w-2.5 h-5" xmls="http://www.w3.org/2000/svg" 
          viewBox="0 0 5 10"
        >
          <rect x="0" y="0" width="5" height="10" :fill="(statVal[param] >= rect ? 'orange' : 'black')"/>
        </svg>
      </div>
      <div
        v-for="param in (4 - stats.size)"
        class="flex flex-row"
      >
        <span> ⠀ </span>
      </div>
      <div
        class="flex flex-row gap-6 pl-6"
      >
        <div
          v-for="n in 3"
          @click="() => clickToStat(n - 1)"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 14 14">
            <path v-for="(pathh, idx) in statData[n - 1].pathes" :d="pathh" :style="'fill:' + (statData[n - 1].active ? 'white' : 'black') + statData[n - 1].strokes[idx]" 
            />
          </svg>              
        </div>
      </div>
      <div
        class="flex flex-row gap-6"
      >
        <div
          v-for="n in 4"
          @click="() => clickToStat(n + 5)"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 14 14">
            <path v-for="(pathh, idx) in statData[n + 5].pathes" :d="pathh" :style="'fill:' + (statData[n + 5].active ? 'white' : 'black') + statData[n + 5].strokes[idx]" :transform="((n == 1 || n == 2) ? 'matrix(.9088 0 0 .9088 -56.463 -130.023)' : '')" 
            />
          </svg>              
        </div>
      </div>
      <div
        class="flex flex-row gap-6 pl-6"
      >
        <div
          v-for="n in 3"
          @click="() => clickToStat(n + 2)"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 14 14">
            <path v-for="(pathh, idx) in statData[n + 2].pathes" :d="pathh" :style="'fill:' + (statData[n + 2].active ? 'white' : 'black') + statData[n - 1].strokes[idx]" 
            />
          </svg>              
        </div>
      </div>
    </div>
    <UButton 
      class="h-10"
    >Сохранить</UButton>
  </VueFinalModal>
</template>
<script setup lang="js">
import { VueFinalModal } from 'vue-final-modal';

const { DiscID } = defineProps(["DiscID"])
const discs = (localStorage.getItem("discs") ? JSON.parse(localStorage.getItem("discs")) : {})
const disc = (Object.hasOwn(discs, DiscID) ? discs[DiscID] : {set: "ThunderMetal"})
const { set, part, main, props } = disc

const statData = ref([
  {
    stat: "cr",
    pathes: [
      "M3.324 1.067C3.546 3.702 2.304 5.637.13 7c2.415 1.075 3.195 3.484 3.195 5.934 0 0 1.592-1.104 3.651-1.104 2.06 0 3.651 1.104 3.651 1.104-.362-2.61 1.078-4.61 3.195-5.934-2.415-1.076-3.195-3.484-3.195-5.933 0 0-1.627 1.102-3.65 1.102-2.025 0-3.652-1.102-3.652-1.102m9.53 1.111a1.12 1.12 0 1 0 0 2.241 1.12 1.12 0 0 0 0-2.24m-3.276.71.022.131c.27 1.495.895 2.913 2.053 3.975l.091.082-.09.086c-1.087 1.022-1.886 2.284-2.167 3.775l-.024.125-.123-.037c-.772-.243-1.6-.392-2.365-.392-.804 0-1.675.164-2.479.43l-.123.042-.023-.13c-.271-1.496-.897-2.912-2.057-3.973l-.092-.082.09-.084C3.384 5.798 4.132 4.538 4.416 3.04l.024-.127.123.04c.789.254 1.636.413 2.412.413.797 0 1.67-.168 2.478-.435z",
      "M7 4.575s.386 1.187.812 1.613S9.425 7 9.425 7s-1.187.386-1.613.812S7 9.425 7 9.425s-.386-1.187-.812-1.613S4.575 7 4.575 7s1.187-.386 1.613-.812S7 4.575 7 4.575"
    ],
    strokes: [
      ";stroke:none;stroke-width:.228206",
      ";stroke:none;stroke-width:.200444"
    ],
    active: false
  },
  {
    stat: "cd",
    pathes: [
      "M3.267.933C3.493 3.628 2.224 5.607 0 7c2.47 1.1 3.267 3.562 3.267 6.067 0 0 1.627-1.128 3.733-1.128s3.733 1.128 3.733 1.128C10.363 10.398 11.836 8.355 14 7c-2.47-1.1-3.267-3.562-3.267-6.067 0 0-1.663 1.128-3.733 1.128S3.267.933 3.267.933M7 4.177s.45 1.382.945 1.878C8.441 6.55 9.823 7 9.823 7s-1.382.45-1.878.945C7.45 8.441 7 9.823 7 9.823s-.45-1.382-.945-1.878C5.559 7.45 4.177 7 4.177 7s1.382-.45 1.878-.945C6.55 5.559 7 4.177 7 4.177"
    ],
    strokes: [
      ";stroke:none;stroke-width:.233336"
    ],
    active: false
  },
  {
    stat: "ap",
    pathes: [
      "M7 .287a6.69 6.69 0 0 0-6.69 6.69A6.69 6.69 0 0 0 7 13.667a6.69 6.69 0 0 0 6.69-6.69A6.69 6.69 0 0 0 7 .287m0 1.739a4.95 4.95 0 0 1 4.952 4.951A4.95 4.95 0 0 1 7 11.93a4.95 4.95 0 0 1-4.952-4.952A4.95 4.95 0 0 1 7 2.026m-2.175.98a.2.2 0 0 0-.204.199v1.733a.3.3 0 0 0 .145.26l2.089 1.296a.27.27 0 0 0 .29 0l2.09-1.296a.3.3 0 0 0 .144-.26V3.205a.2.2 0 0 0-.304-.17L7 4.323 4.925 3.035a.2.2 0 0 0-.1-.029Zm-.632 2.888a.3.3 0 0 0-.148.04L2.544 6.8a.2.2 0 0 0 .005.348l2.153 1.154-.078 2.44a.2.2 0 0 0 .299.179l1.5-.867a.3.3 0 0 0 .153-.254l.078-2.46a.27.27 0 0 0-.144-.25L4.342 5.93a.3.3 0 0 0-.15-.035Zm5.614 0a.3.3 0 0 0-.149.034L7.49 7.09a.27.27 0 0 0-.144.25l.077 2.46a.3.3 0 0 0 .153.254l1.5.867a.2.2 0 0 0 .3-.18l-.078-2.44 2.153-1.153a.2.2 0 0 0 .005-.349l-1.5-.866a.3.3 0 0 0-.149-.04Z"
    ],
    strokes: [
      ";stroke-width:1.21664;stroke-linecap:square;stroke-dashoffset:3.77952"
    ],
    active: false
  },
  {
    stat: "atk%",
    pathes: [
      "M5.096.49v5.167a1.08 1.08 0 0 0 1.08 1.08h1.667a1.08 1.08 0 0 0 1.08-1.08V.491ZM1.4 1.182a.74.74 0 0 0-.742.742v3.362A1.45 1.45 0 0 0 2.11 6.737h2.07a.305.305 0 0 0 .305-.305V1.436a.255.255 0 0 0-.255-.255Zm8.475 0a.34.34 0 0 0-.34.341v4.875a.34.34 0 0 0 .34.34h2.034a1.45 1.45 0 0 0 1.452-1.452V1.923a.74.74 0 0 0-.742-.742Zm-7.76 6.345A1.476 1.476 0 0 0 .64 9.002v3.03a1.476 1.476 0 0 0 1.476 1.477h9.77a1.476 1.476 0 0 0 1.476-1.476v-3.03a1.476 1.476 0 0 0-1.476-1.477H6.642a.81.81 0 0 0-.81.809v.782a.743.743 0 0 0 .744.743h2.258a.483.483 0 0 1 .484.483v.339a.394.394 0 0 1-.395.395H5.4a.717.717 0 0 1-.717-.717V7.864a.34.34 0 0 0-.338-.338Z"
    ],
    strokes: [
      ";stroke-width:.909407;stroke-linecap:square;stroke-dashoffset:3.77952;stop-color:#000",
    ],
    active: false
  },
  {
    stat: "atk",
    pathes: [
      "M5.096.49v5.167a1.08 1.08 0 0 0 1.08 1.08h1.667a1.08 1.08 0 0 0 1.08-1.08V.491ZM1.4 1.182a.74.74 0 0 0-.742.742v3.362A1.45 1.45 0 0 0 2.11 6.737h2.07a.305.305 0 0 0 .305-.305V1.436a.255.255 0 0 0-.255-.255Zm8.475 0a.34.34 0 0 0-.34.341v4.875a.34.34 0 0 0 .34.34h2.034a1.45 1.45 0 0 0 1.452-1.452V1.923a.74.74 0 0 0-.742-.742Zm-7.76 6.345A1.476 1.476 0 0 0 .64 9.002v3.03a1.476 1.476 0 0 0 1.476 1.477h9.77a1.476 1.476 0 0 0 1.476-1.476v-3.03a1.476 1.476 0 0 0-1.476-1.477H6.642a.81.81 0 0 0-.81.809v.782a.743.743 0 0 0 .744.743h2.258a.483.483 0 0 1 .484.483v.339a.394.394 0 0 1-.395.395H5.4a.717.717 0 0 1-.717-.717V7.864a.34.34 0 0 0-.338-.338Z"
    ],
    strokes: [
      ";stroke-width:.909407;stroke-linecap:square;stroke-dashoffset:3.77952;stop-color:#000",
    ],
    active: false
  },
  {
    stat: "pen",
    pathes: [
      "M9.425 0 6.806 2.732.371.462 2.79 6.757.091 9.415l9.793.28Zm1.58 3.34.137 2.875c.435.61.67 1.339.67 2.087a3.6 3.6 0 0 1-3.6 3.602c-.87-.001-1.71-.317-2.366-.89l-2.682-.076A5.7 5.7 0 0 0 8.211 14a5.698 5.698 0 0 0 2.795-10.66z"
    ],
    strokes: [
      ";stroke:none;stroke-width:.279774"
    ],
    active: false
  },
  {
    stat: "hp%",
    pathes: [
      "M69.609 143.14c-.99 1.034-5.872 6.293-5.86 8.987.023 4.992 4.376 7.404 8.375 5.914.7-.261 1.294-.675 1.825-1.198 3.243-3.198 1.972-7.063-.222-9.242l-3.806-4.452a.207.207 0 0 0-.312-.01zm3.304 6.883c-2.947-.67-2.915 2.468-5.26 2.04-.76-.138-1.242-.545-1.445-1.126.128-.588 2.736-3.688 3.407-4.49a.217.217 0 0 1 .328-.016c.76.774 2.854 3.093 2.97 3.592",
    ],
    strokes: [
      ";stroke:none"
    ],
    active: false
  },
  {
    stat: "hp",
    pathes: [
      "M69.609 143.14c-.99 1.034-5.872 6.293-5.86 8.987.023 4.992 4.376 7.404 8.375 5.914.7-.261 1.294-.675 1.825-1.198 3.243-3.198 1.972-7.063-.222-9.242l-3.806-4.452a.207.207 0 0 0-.312-.01zm3.304 6.883c-2.947-.67-2.915 2.468-5.26 2.04-.76-.138-1.242-.545-1.445-1.126.128-.588 2.736-3.688 3.407-4.49a.217.217 0 0 1 .328-.016c.76.774 2.854 3.093 2.97 3.592",
    ],
    strokes: [
      ";stroke:none"
    ],
    active: false
  },
  {
    stat: "def%",
    pathes: [
      "M6.963.207S5.672.655 5.086.824a22 22 0 0 1-3.167.677c-.38.052-1.712.174-1.712.174s.026.848.03 1.106c.014.782.13 1.614.277 2.383.549 2.848 1.644 5.718 4.077 7.475.67.484 1.697 1.234 2.573 1.147.822-.08 1.729-.712 2.374-1.188 2.346-1.731 3.473-4.556 3.997-7.335.154-.815.258-1.653.258-2.482 0-.265-.041-1.133-.041-1.133s-1.34-.1-1.74-.166A30 30 0 0 1 8.747.753C8.204.6 6.963.207 6.963.207m-4.45 3.268c1.517-.149 3.49-.565 4.453-.951 1.024.456 4.566.94 4.566.94.037.73-.075 1.73-.23 2.446-.417 1.923-1.216 4.05-3.3 5.232-.33.187-1.032.423-1.032.423s-.905-.15-2.156-1.296C3.02 8.516 2.513 5.893 2.513 3.476m4.453.099c-1.117.38-2.248.675-3.427.717.152 2.067.374 4.056 2.24 5.565.358.29.64.483 1.214.565.595-.074 1.1-.4 1.455-.69 1.082-.885 1.701-2.306 1.882-3.674.054-.412.135-1.735.135-1.735-1.137-.02-2.355-.398-3.5-.748",
    ],
    strokes: [
      ";stroke:none;stroke-width:.374906"
    ],
    active: false
  },
  {
    stat: "def",
    pathes: [
      "M6.963.207S5.672.655 5.086.824a22 22 0 0 1-3.167.677c-.38.052-1.712.174-1.712.174s.026.848.03 1.106c.014.782.13 1.614.277 2.383.549 2.848 1.644 5.718 4.077 7.475.67.484 1.697 1.234 2.573 1.147.822-.08 1.729-.712 2.374-1.188 2.346-1.731 3.473-4.556 3.997-7.335.154-.815.258-1.653.258-2.482 0-.265-.041-1.133-.041-1.133s-1.34-.1-1.74-.166A30 30 0 0 1 8.747.753C8.204.6 6.963.207 6.963.207m-4.45 3.268c1.517-.149 3.49-.565 4.453-.951 1.024.456 4.566.94 4.566.94.037.73-.075 1.73-.23 2.446-.417 1.923-1.216 4.05-3.3 5.232-.33.187-1.032.423-1.032.423s-.905-.15-2.156-1.296C3.02 8.516 2.513 5.893 2.513 3.476m4.453.099c-1.117.38-2.248.675-3.427.717.152 2.067.374 4.056 2.24 5.565.358.29.64.483 1.214.565.595-.074 1.1-.4 1.455-.69 1.082-.885 1.701-2.306 1.882-3.674.054-.412.135-1.735.135-1.735-1.137-.02-2.355-.398-3.5-.748",
    ],
    strokes: [
      ";stroke:none;stroke-width:.374906"
    ],
    active: false
  }
])
const stats = ref(new Set())
const statVal = ref({})
const sumVal = 0

const clickToStat = (param, activity) => {
  if (!activity && stats.value.size == 4) {
    return 0
  }
  if (statData.value[n].active) {
    stats.value.delete(param)
    sumVal -= (1 + statVal[param])
  } else {
    stats.value.add(param)
    statVal.value[param] = 0 
  }
  statData.value[n].active = !statData.value[n].active 
}

const clickToValue = (param, val) => {
  
  statVal.value[param] = val
}
</script>